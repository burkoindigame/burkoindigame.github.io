<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Предзаказ игры</title>
    <script src="https://cdn.jsdelivr.net/npm/web3/dist/web3.min.js"></script>
    <script type="text/javascript"
            src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js">
    </script>
</head>
<body>
    <h1>Предзаказ вашей игры</h1>
    <button id="preorderButton">Предзаказать за 1 доллар</button>
    <div id="form" style="display:none;">
        <input type="text" id="name" placeholder="Ваше имя" required>
        <input type="email" id="email" placeholder="Ваш email" required>
        <button id="submit">Отправить</button>
    </div>
    <script>
        // Инициализация EmailJS
        (function(){
            emailjs.init({publicKey: "rp0sKAlvyGeosNICv"}); // Замените на ваш User ID
        })();

        const preorderButton = document.getElementById('preorderButton');
        const form = document.getElementById('form');
        const submitButton = document.getElementById('submit');

        preorderButton.onclick = async () => {
            if (typeof window.ethereum !== 'undefined') {
                const web3 = new Web3(window.ethereum);
                await window.ethereum.request({ method: 'eth_requestAccounts' });
                const accounts = await web3.eth.getAccounts();

                // Оплата 1 доллар в Wei (пример)
                const price = web3.utils.toWei('1', 'ether');

                // Здесь должен быть ваш контракт и функция для оплаты
                // await contract.methods.pay().send({ from: accounts[0], value: price });

                form.style.display = 'block';
            } else {
                alert('Пожалуйста, установите MetaMask!');
            }
        };

        submitButton.onclick = async () => {
            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;

            // Отправка данных через EmailJS
            emailjs.send('service_wlsifjm', 'template_ennh41a', {
                name: name,
                email: email
            })
            .then((response) => {
                alert('Предзаказ успешно оформлен!');
            }, (error) => {
                alert('Ошибка при оформлении предзаказа: ' + JSON.stringify(error));
            });
        };
    </script>
</body>
</html> 

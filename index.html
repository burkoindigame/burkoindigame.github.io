<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Предзаказ игры / Game Preorder</title>
  <script src="https://cdn.jsdelivr.net/npm/web3/dist/web3.min.js"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 400px;
      margin: 30px auto;
      padding: 0 15px;
      background-color: #800000; /* Бордовый фон */
      color: white; /* Цвет текста для лучшей читаемости */
    }
    #langSwitcher {
      margin-bottom: 20px;
      text-align: right;
    }
    #langSwitcher button {
      margin-left: 10px;
      padding: 5px 10px;
      cursor: pointer;
    }
    #status {
      margin-top: 10px;
      min-height: 20px;
      font-weight: bold;
    }
    #form input {
      display: block;
      width: 100%;
      margin-bottom: 10px;
      padding: 8px;
      font-size: 1em;
    }
    #form button {
      padding: 10px 20px;
      font-size: 1em;
      cursor: pointer;
    }
    #payButton, #noWalletButton {
      display: block;
      width: 100%;
      margin-bottom: 10px;
      padding: 10px 20px;
      font-size: 1em;
      cursor: pointer;
      border: none;
      border-radius: 4px;
    }
    #payButton {
      background-color: #b22222; /* темно-красный */
      color: white;
    }
    #noWalletButton {
      background-color: #444444;
      color: white;
      text-decoration: none;
      text-align: center;
      line-height: normal;
    }
    #noWalletButton:hover {
      background-color: #666666;
    }
    #screenshots {
      margin-top: 20px;
    }
    #screenshotsTitle {
      text-align: center;
      margin-bottom: 10px;
    }
    .screenshots-container {
      display: flex;
      gap: 10px;
      justify-content: center;
      flex-wrap: wrap;
    }
    .screenshots-container img {
      max-width: 500px;
      width: 100%;
      height: auto;
      border: 2px solid white;
      border-radius: 6px;
      cursor: pointer;
      transition: transform 0.3s ease;
    }
    .screenshots-container img:hover {
      transform: scale(1.05);
      border-color: #b22222;
    }
    #lightbox {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0,0,0,0.85);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }

    #lightbox-content {
      position: relative;
      max-width: 90vw;
      max-height: 90vh;
    }

    #lightbox-img {
      max-width: 100%;
      max-height: 100%;
      border-radius: 8px;
      box-shadow: 0 0 15px #b22222;
    }

    #lightbox-close {
      position: absolute;
      top: -15px;
      right: -15px;
      font-size: 2.5em;
      color: white;
      cursor: pointer;
      user-select: none;
      font-weight: bold;
      background: #b22222;
      border-radius: 50%;
      width: 36px;
      height: 36px;
      line-height: 36px;
      text-align: center;
    }
    #lightbox-close:hover {
      background: #7a1616;
    }
    
  </style>
</head>
<body>
  <div id="langSwitcher">
    <span id="labelLang">Язык / Language:</span>
    <button data-lang="ru" id="btnRu">Русский</button>
    <button data-lang="en" id="btnEn">English</button>
  </div>

  <h1 id="title">Предзаказ вашей игры</h1>
  <button id="payButton">Оплатить 1$ (0.0002385 ETH) c MetaMask</button>
  <a href="https://metamask.io/download/" target="_blank" id="noWalletButton">У меня нет кошелька</a>
  <div id="status"></div>
  
  
  <div id="form" style="display:none;">
    <input type="text" id="name" placeholder="Ваше имя" required>
    <input type="email" id="email" placeholder="Ваш email" required>
    <button id="submit">Отправить</button>
  </div>
  <div id="screenshots">
    <h2 id="screenshotsTitle">Скриншоты / Screenshots</h2>
    <div class="screenshots-container">
      <img src="sc1.png" alt="Screenshot 1" class="screenshot-thumb" data-full="sc1.png" />
      <img src="sc2.png" alt="Screenshot 2" class="screenshot-thumb" data-full="sc2.png" />
      <img src="sc3.png" alt="Screenshot 3" class="screenshot-thumb" data-full="sc3.png" />
    </div>
  </div>


  
        
  <div id="lightbox" style="display:none;">
    <div id="lightbox-content">
      <span id="lightbox-close">&times;</span>
      <img id="lightbox-img" src="" alt="Large screenshot" />
    </div>
  </div>
  <script>
    const lightbox = document.getElementById('lightbox');
    const lightboxImg = document.getElementById('lightbox-img');
    const lightboxClose = document.getElementById('lightbox-close');

    document.querySelectorAll('.screenshot-thumb').forEach(img => {
      img.addEventListener('click', () => {
        const fullSrc = img.dataset.full || img.src; // если нет data-full, открываем миниатюру
        lightboxImg.src = fullSrc;
        lightbox.style.display = 'flex';
      });
    });

    lightboxClose.addEventListener('click', () => {
      lightbox.style.display = 'none';
      lightboxImg.src = '';
    });

    // Закрытие лайтбокса по клику вне картинки
    lightbox.addEventListener('click', (e) => {
      if (e.target === lightbox) {
        lightbox.style.display = 'none';
        lightboxImg.src = '';
      }
    });

    // Текущий язык (по умолчанию русский)
    let currentLang = 'ru';

    // Тексты на двух языках
    const texts = {
      ru: {
        title: 'Предзаказ AlcoBattle',
        payButton: 'Оплатить 1$ (0.0002385 ETH) c MetaMask',
        statusNoMetaMask: 'Пожалуйста, установите MetaMask!',
        statusTxSent: 'Транзакция отправлена. Хэш: ',
        statusError: 'Ошибка: ',
        namePlaceholder: 'Ваше имя',
        emailPlaceholder: 'Ваш email',
        submitButton: 'Отправить',
        preorderSuccess: 'Предзаказ успешно оформлен!',
        preorderError: 'Ошибка при оформлении предзаказа: ',
        labelLang: 'Язык / Language:',
        noWalletButton: 'У меня нет кошелька'
      },
      en: {
        title: 'AlcoBattle Preorder',
        payButton: 'Pay 1$ (0.0002385 ETH) with MetaMask',
        statusNoMetaMask: 'Please install MetaMask!',
        statusTxSent: 'Transaction sent. Hash: ',
        statusError: 'Error: ',
        namePlaceholder: 'Your name',
        emailPlaceholder: 'Your email',
        submitButton: 'Submit',
        preorderSuccess: 'Preorder submitted successfully!',
        preorderError: 'Error submitting preorder: ',
        labelLang: 'Language / Язык:',
        noWalletButton: "I don't have a wallet"
      }
    };

    
    // Функция обновления текста на странице
    function updateTexts() {
      const t = texts[currentLang];
      document.getElementById('title').innerText = t.title;
      document.getElementById('payButton').innerText = t.payButton;
      document.getElementById('name').placeholder = t.namePlaceholder;
      document.getElementById('email').placeholder = t.emailPlaceholder;
      document.getElementById('submit').innerText = t.submitButton;
      document.getElementById('labelLang').innerText = t.labelLang;
      document.getElementById('noWalletButton').innerText = t.noWalletButton;
      // Очистим статус при смене языка
      document.getElementById('status').innerText = '';
    }

    // Инициализация EmailJS
    (function(){
        emailjs.init({publicKey: "rp0sKAlvyGeosNICv"}); // Замените на ваш User ID
    })();

    const payButton = document.getElementById('payButton');
    const statusDiv = document.getElementById('status');
    const form = document.getElementById('form');
    const submitButton = document.getElementById('submit');

    async function payWithMetaMask() {
      const t = texts[currentLang];
      if (typeof window.ethereum === 'undefined') {
        statusDiv.innerText = t.statusNoMetaMask;
        return;
      }

      try {
        // Запросить доступ к аккаунту
        const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
        const from = accounts[0];

        // Адрес получателя (ваш кошелек)
        const to = '0x5526ce5082c0a5Fa94f80d336539709C2F36eb58'; // Замените на ваш Ethereum-адрес

        // Сумма в wei (0.0002385 ETH)
        const amountEth = 0.0002385;
        const valueWei = BigInt(Math.round(amountEth * 1e18)).toString(16);

        // Отправка транзакции
        const txHash = await window.ethereum.request({
          method: 'eth_sendTransaction',
          params: [{
            from,
            to,
            value: '0x' + valueWei,
          }],
        });

        statusDiv.innerText = t.statusTxSent + txHash;
        
        // Показать форму после успешной оплаты
        form.style.display = 'block';
      } catch (error) {
        statusDiv.innerText = t.statusError + error.message;
      }
    }

    payButton.addEventListener('click', payWithMetaMask);

    submitButton.onclick = async () => {
      const t = texts[currentLang];
      const name = document.getElementById('name').value.trim();
      const email = document.getElementById('email').value.trim();

      if (!name || !email) {
        alert(currentLang === 'ru' ? 'Пожалуйста, заполните все поля!' : 'Please fill all fields!');
        return;
      }

      try {
        await emailjs.send('service_wlsifjm', 'template_ennh41a', {
          name: name,
          email: email
        });
        alert(t.preorderSuccess);
        form.style.display = 'none';
        statusDiv.innerText = '';
        // Очистить поля
        document.getElementById('name').value = '';
        document.getElementById('email').value = '';
      } catch (error) {
        alert(t.preorderError + JSON.stringify(error));
      }
    };

    // Переключение языка
    document.getElementById('btnRu').addEventListener('click', () => {
      currentLang = 'ru';
      updateTexts();
    });
    document.getElementById('btnEn').addEventListener('click', () => {
      currentLang = 'en';
      updateTexts();
    });

    // Инициализация текста при загрузке
    updateTexts();
  </script>
</body>
</html>
